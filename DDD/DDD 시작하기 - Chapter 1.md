# 도메인 모델 시작하기

## 도메인
- 도메인은 다수의 하위 도메인으로 구성

## 도메인 모델
- 특정 도메인을 개념적으로 표현한 것 (도메인 자체를 이해하기 위한 개념 모델)
- 도메인 모델을 사용하면 여러 관계자들이 동일한 모습으로 도메인을 이해하고 도메인을 지식을 공유하는 데 도움이 됨
- 도메인을 이해하는 데 도움이 된다면 표현 방식이 무엇인지는 중요하지 않음 (객체 모델, 상태 다이어그램, 클래스 다이어그램 등)
- 모델의 각 구성요소는 특정 도메인으로 한정할 때 비로소 의미가 완전해지므로 각 하위 도메인마다 별도의 모델을 만들어야 함 (ex. 카탈로그-상품 vs 배송-상품)

### 도메인 모델 패턴
- 표현 - 응용 - 도메인 - 인프라스트럭처
- 도메인 계층은 도메인의 핵심 규칙을 구현 (ex. 출고 전에 배송지를 변경할 수 있다, 주문 취소는 배송 전에만 할 수 있다)
- 도메인 규칙을 객체 지향 기법으로 구현하는 패턴이 도메인 모델 패턴

### 도메인 모델 도출
- 도메인을 모델링할 떄 기본이 되는 작업은 모델을 구성하는 핵심 구성요소, 규칙, 기능을 찾는 것 → 이 과정은 요구사항에서 출발
```text
* 문서화
- 문서화를 하는 주된 이유는 지식을 공유하기 위함
- 코드를 보면서 도메인을 깊게 이해하게 되므로 코드 자체도 문서화의 대상이 됨
    - 도메인 지식이 잘 묻어나도록 코드를 작성하지 않으면 코드의 동작 과정은 해석할 수 있어도 도메인 관점에서 왜 코드를 그렇게 작성했는지 이해하는 데는 도움 X
    - 단순히 코드를 보기 좋게 작성하는 것 뿐만 아니라 도메인 관점에서 코드가 도메인을 잘 표현해야 비로소 코드의 가독성이 높아지고 문서로서 코드가 의미를 가짐
```

## 엔티티와 밸류
- 도출한 모델은 크게 엔티티와 밸류로 구분
- 엔티티
  - 식별자를 가짐
  - 두 엔티티 객체의 식별자가 같으면 두 엔티티는 같다고 판단할 수 있음
  - 식별자 생성 방식 → 특정 규칙에 따라 / 고유 식별자 생성기 사용 (UUID, Nano ID) / 값을 직접 입력 / 일련변호 사용 (시퀀스나 DB 자동 증가 컬럼)
- 밸류 타입
  - 개념적으로 완전한 하나를 표현할 때 사용
  - 밸류 타입이 꼭 두 개 이상의 데이터를 가져야 하는 것은 아님 (ex. Money)
  - 밸류 타입을 위한 기능을 추가할 수 있음 (장점)
  - 데이터를 변경할 때는 기존 데이터를 변경하기보다는 변경한 데이터를 갖는 새로운 밸류 객체를 생성하는 방식 선호
    - 데이터 변경 기능을 제공하지 않는 타입을 불변(immutable)이라 표현
    - 불변 객체는 참조 투명성과 스레드에 안전한 특징을 가지고 있음
  - 두 밸류 객체를 비교할 때는 모든 속성이 같은지 비교
- 식별자는 단순한 문자열이 아니라 도메인에서 특별한 의미를 지니는 경우가 많기 때문에 식별자를 위한 밸류 타입을 사용해 의미가 잘 드러나도록 할 수 있음
  - ex. _"String id"_ vs _"String orderNo"_ vs _"OrderNo id"_
- set 메서드는 도메인의 핵심 개념이나 의도를 코드에서 사라지게 함
- 도메인 객체가 불완전한 상태로 사용되는 것을 막으려면 생성 시점에 필요한 것을 전달해주어야 함 (→ 생성자 통해 필요한 데이터 모두 받기)

## 도메인 용어
- 코드를 작성할 때 도메인에서 사용하는 용어는 매우 중요함
  - 도메인 용어를 코드에 반영하지 않으면 그 코드는 개발자에게 코드의 의미를 해석해야 하는 부담을 줌
  - 도메인에서 사용하는 용어를 최대한 코드에 반영하면 코드의 가독성을 높여 코드를 분석하고 이해하는 시간을 줄여줌
  - 도메인 용어에 알맞은 단어를 찾는 시간을 아까워하지 말 것